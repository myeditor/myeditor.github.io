<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <script>
    const token = localStorage.getItem('personal_access_token');
    if (!token) {
      location.href = "/login.html";
    }
  </script>
  <title>文章列表</title>
</head>

<body>
  <div id="app">
    <ul>
      <li v-for="content in contents">
        <!-- 暂时假定都是文件 -->
        <a v-bind:href="`${baseURL}path=${content.path}`">{{content.type==='file'?'文件':'目录'}}{{content.name}}</a>
      </li>
    </ul>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script type="module">
    import GithubAPI from "./src/GithubAPI.js";
    import query from './src/Query.js';
    const api = new GithubAPI();
    api.blogs(query.owner, query.repo_name).then(contents=>{
      console.log(contents);
      // TODO 要将dir中的文件遍历出来，形成一个都文件的列表
      new Vue({
        el: '#app',
        data: {
          baseURL:`/editor.html${window.location.search}&`,
          contents: contents.sort((a, b) => a.dir==='dir')
        }
      })
    })
  </script>
</body>

</html>